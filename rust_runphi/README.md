## To install rust 
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
## install crosscompiler
apt install gcc-aarch64-linux-gnu 
## To build
cargo build --release --target=aarch64-unknown-linux-gnu
## Adding support for a new target board
To add support for a new board in the config generator you need to know how a standard jailhouse configuration for that board is done. In the module templates.rs are available various templates for the preamble, the memory regions, the interrupt request chip and the pci devices. 
Here is an example for a memory region mapping an UART device.
```rust
pub const UART_TEMPLATE: &'static str = r#"
/* UART */ {
    .phys_start = {phys_start},
    .virt_start = {virt_start},
    .size = {size},
    .flags = JAILHOUSE_MEM_READ | JAILHOUSE_MEM_WRITE |
        JAILHOUSE_MEM_IO | JAILHOUSE_MEM_ROOTSHARED,
},
"#;
```
Note that the physical start, virtual start and size fields can be customized by using board specific values.
If none of the templates can be used for your board standard configuration you can add others. 
The configuration is then generated by giving runphi a .toml file containing the templates to use for your target and the board specific values with which to fill the templates.
Here is an examble for the KriaKV260 board:
```toml
[mem_regions]
regions = ["IVSHMEM_TEMPLATE", "UART_TEMPLATE", "TCMA_TEMPLATE", "TCMB_TEMPLATE", "RAM_TEMPLATE", "COMM_REGION_TEMPLATE"]

[jailhouse_preamble]
preamble = "ULTRASCALE_PREAMBLE"

[IVSHMEM_TEMPLATE]
address = "0x060000000"

[UART_TEMPLATE]
phys_start = "0xff010000"
virt_start = "0xff010000"
size = "0x1000"

[TCMA_TEMPLATE]
phys_start = "0xffe00000"
virt_start = "0xffe00000"
size = "0x00010000"

[TCMB_TEMPLATE]
phys_start = "0xffe20000"
virt_start = "0xffe20000"
size = "0x00010000"

[RAM_TEMPLATE]
phys_start = "0x3ed00000"
virt_start = "0"
size = "0x8000000"

[COMM_REGION_TEMPLATE]
# No additional parameters

[devices]
devs = ["IRQ_CHIP_BOARD_TEMPLATE", "PCI_DEVICE_TEMPLATE"]

[IRQ_CHIP_BOARD_TEMPLATE]
gic_address = "0xf9010000"
uart_pin = "33"
ivshmem_pin = "146"

[PCI_DEVICE_TEMPLATE]
ivshmem_bdf = "1"
```

Moreover, it is also necessary to gice the board an initial state file with .toml extension. 
Here's an example for the same target:
```toml
[containerid]
ids = []

[available_memory]
memory = "0x70000000, 0x7f800000"

[free_segments]
segments= ["0x70000000, 0x7f800000"]

[free_pci_devices_bdf]
bdf = [1,2]

[free_rcpus]
ids = [0,1]
```
This file must be populated with the resources that we can assign to the partitioned container defined in the particular root cell configuration used. Most important is the memory available to be assigned to the non-root cells which will also be the initial free memory segment. This value changes depending from the board and must be known in order not to cause crashes.
